<html><head><base href="https://websim.ai/c/chatios-friend-requests"><title>ChatIOS - Friend Requests</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="manifest" href="/manifest.json" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <link rel="apple-touch-icon" href="/icon-192x192.png" />
  <style>
    body, html {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      background-color: #f2f2f7;
      height: 100%;
      overflow: hidden;
    }
    #app {
      display: flex;
      flex-direction: column;
      height: 100vh;
    }
    .header {
      background-color: #f2f2f7;
      padding: 10px 15px;
      text-align: center;
      font-weight: bold;
      font-size: 18px;
      border-bottom: 1px solid #c8c7cc;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .friend-list, .request-list {
      flex: 1;
      overflow-y: auto;
      padding: 10px;
    }
    .friend-item, .request-item {
      padding: 15px;
      border-bottom: 1px solid #c8c7cc;
      display: flex;
      align-items: center;
    }
    .friend-avatar {
      width: 50px;
      height: 50px;
      border-radius: 25px;
      margin-right: 15px;
      background-color: #007aff;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 20px;
    }
    .friend-info {
      flex: 1;
    }
    .friend-name {
      font-weight: bold;
      margin-bottom: 5px;
    }
    .last-message {
      color: #8e8e93;
      font-size: 14px;
    }
    .login-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      padding: 20px;
    }
    .login-input {
      width: 100%;
      max-width: 300px;
      padding: 10px;
      margin: 10px 0;
      border: 1px solid #c8c7cc;
      border-radius: 5px;
      font-size: 16px;
    }
    .login-button {
      width: 100%;
      max-width: 300px;
      padding: 10px;
      margin: 10px 0;
      background-color: #007aff;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }
    .add-friend-button {
      background-color: #007aff;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 5px 10px;
      font-size: 14px;
      cursor: pointer;
      margin-left: 10px;
    }
    .notification {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #007aff;
      color: white;
      padding: 10px 20px;
      border-radius: 5px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      z-index: 1000;
    }
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 10px;
      max-width: 80%;
      max-height: 80%;
      overflow-y: auto;
    }
    .request-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
    }
    .request-button {
      padding: 5px 10px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
    }
    .accept-button {
      background-color: #34c759;
      color: white;
    }
    .reject-button {
      background-color: #ff3b30;
      color: white;
    }
    .pending-request {
      color: #ff9500;
      font-style: italic;
    }
  </style>
</head>
<body>
  <div id="app">
    <div v-if="!loggedIn" class="login-container">
      <h2>Welcome to ChatIOS</h2>
      <input type="email" v-model="email" placeholder="Email" class="login-input">
      <input type="password" v-model="password" placeholder="Password" class="login-input">
      <button @click="login" class="login-button">Log In</button>
      <button @click="signup" class="login-button">Sign Up</button>
    </div>
    
    <template v-else>
      <div class="header">
        <span>Chats</span>
        <div>
          <button @click="showAddFriendModal = true" class="add-friend-button">Add Friend</button>
        </div>
      </div>
      
      <div v-if="friendRequests.length > 0" class="request-list">
        <h3>Friend Requests</h3>
        <div v-for="request in friendRequests" :key="request.email" class="request-item">
          <div class="friend-avatar">{{ request.email[0].toUpperCase() }}</div>
          <div class="friend-info">
            <div class="friend-name">{{ request.email }}</div>
          </div>
          <div class="request-buttons">
            <button @click="acceptFriendRequest(request)" class="request-button accept-button">Accept</button>
            <button @click="rejectFriendRequest(request)" class="request-button reject-button">Reject</button>
          </div>
        </div>
      </div>

      <div v-if="friends.length === 0 && pendingRequests.length === 0" style="text-align: center; padding: 20px;">
        You have no friends yet. Add some friends to start chatting!
      </div>
      
      <div v-else class="friend-list">
        <div v-for="request in pendingRequests" :key="request.email" class="friend-item">
          <div class="friend-avatar">{{ request.email[0].toUpperCase() }}</div>
          <div class="friend-info">
            <div class="friend-name">{{ request.email }}</div>
            <div class="pending-request">Request Pending</div>
          </div>
        </div>
        <div v-for="friend in friends" :key="friend.email" @click="openChat(friend)" class="friend-item">
          <div class="friend-avatar">{{ friend.email[0].toUpperCase() }}</div>
          <div class="friend-info">
            <div class="friend-name">{{ friend.email }}</div>
            <div class="last-message">{{ friend.lastMessage || 'No messages yet' }}</div>
          </div>
        </div>
      </div>
    </template>

    <!-- Add Friend Modal -->
    <div v-if="showAddFriendModal" class="modal">
      <div class="modal-content">
        <h3>Add Friend</h3>
        <input v-model="newFriendEmail" placeholder="Friend's Email" class="login-input">
        <button @click="sendFriendRequest" class="login-button">Send Request</button>
        <button @click="showAddFriendModal = false" class="login-button" style="background-color: #ff3b30;">Cancel</button>
      </div>
    </div>

    <!-- Notification -->
    <div v-if="notification" class="notification">
      {{ notification }}
    </div>
  </div>

  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script>
    const { createApp, ref, onMounted } = Vue

    createApp({
      setup() {
        const loggedIn = ref(false)
        const email = ref('')
        const password = ref('')
        const friends = ref([])
        const friendRequests = ref([])
        const pendingRequests = ref([])
        const showAddFriendModal = ref(false)
        const newFriendEmail = ref('')
        const notification = ref('')

        const login = () => {
          if (email.value && password.value) {
            loggedIn.value = true
            // Simulate receiving friend requests
            setTimeout(() => {
              friendRequests.value = [
                { email: 'john@example.com' },
                { email: 'sarah@example.com' }
              ]
            }, 2000)
          }
        }

        const signup = () => {
          if (email.value && password.value) {
            loggedIn.value = true
            friends.value = []
          }
        }

        const sendFriendRequest = () => {
          if (newFriendEmail.value && !friends.value.some(f => f.email === newFriendEmail.value) && !pendingRequests.value.some(r => r.email === newFriendEmail.value)) {
            pendingRequests.value.push({ email: newFriendEmail.value })
            showAddFriendModal.value = false
            newFriendEmail.value = ''
            notification.value = `Friend request sent to ${newFriendEmail.value}`
            setTimeout(() => {
              notification.value = ''
            }, 3000)
          } else {
            notification.value = 'Invalid email or request already sent'
            setTimeout(() => {
              notification.value = ''
            }, 3000)
          }
        }

        const acceptFriendRequest = (request) => {
          friends.value.push({ email: request.email, messages: [] })
          friendRequests.value = friendRequests.value.filter(r => r.email !== request.email)
          notification.value = `${request.email} added as a friend!`
          setTimeout(() => {
            notification.value = ''
          }, 3000)
        }

        const rejectFriendRequest = (request) => {
          friendRequests.value = friendRequests.value.filter(r => r.email !== request.email)
          notification.value = `Friend request from ${request.email} rejected`
          setTimeout(() => {
            notification.value = ''
          }, 3000)
        }

        onMounted(() => {
          if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js')
          }
        })

        return {
          loggedIn,
          email,
          password,
          login,
          signup,
          friends,
          friendRequests,
          pendingRequests,
          showAddFriendModal,
          newFriendEmail,
          sendFriendRequest,
          acceptFriendRequest,
          rejectFriendRequest,
          notification
        }
      }
    }).mount('#app')
  </script>
</body>
</html>